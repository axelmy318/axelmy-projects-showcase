import bodyParser from 'body-parser';
import Validator from 'express-ts-validator';

const userEdit = new Validator({
    name: { type: 'string', notEmpty: true },
    age: { type: 'number', required: false },
    birthdate: { type: 'date', format: 'YYYY-MM-DD' },
    hobbies: { type: 'string', list: true },
    pets: {
        type: 'object',
        list: true,
        validator: {
            name: { type: 'string' },
            isNice: { type: 'bool' }
        }
    }
});

router.post('user/:id/edit', bodyParser.json(), userEdit.validate, (req: Request & { body: typeof userEdit.schema; }, res: Response) => {
    console.log(req.body.pets.map(p => `${p.name} is ${p.isNice ? 'nice' : 'naughty'}`));
    res.status(200).send('The entire request body is automatically typed !');
});
